(function(t){function e(e){for(var a,c,o=e[0],r=e[1],h=e[2],u=0,f=[];u<o.length;u++)c=o[u],Object.prototype.hasOwnProperty.call(n,c)&&n[c]&&f.push(n[c][0]),n[c]=0;for(a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);l&&l(e);while(f.length)f.shift()();return s.push.apply(s,h||[]),i()}function i(){for(var t,e=0;e<s.length;e++){for(var i=s[e],a=!0,o=1;o<i.length;o++){var r=i[o];0!==n[r]&&(a=!1)}a&&(s.splice(e--,1),t=c(c.s=i[0]))}return t}var a={},n={app:0},s=[];function c(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,c),i.l=!0,i.exports}c.m=t,c.c=a,c.d=function(t,e,i){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(c.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)c.d(i,a,function(e){return t[e]}.bind(null,a));return i},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/simply-chess/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],r=o.push.bind(o);o.push=e,o=o.slice();for(var h=0;h<o.length;h++)e(o[h]);var l=r;s.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("cd49")},"00f2":function(t,e,i){"use strict";i("2c17")},"2a19":function(t,e,i){t.exports=i.p+"img/81.518cd5f8.svg"},"2c17":function(t,e,i){},"2c77":function(t,e,i){t.exports=i.p+"img/98.702c526d.svg"},"2ce2":function(t,e,i){t.exports=i.p+"img/75.5aad6e48.svg"},3036:function(t,e,i){t.exports=i.p+"img/112.876f1ece.svg"},"30a4":function(t,e,i){t.exports=i.p+"img/78.e6294efe.svg"},"3aae":function(t,e,i){t.exports=i.p+"img/107.8805b9ad.svg"},"49be":function(t,e,i){t.exports=i.p+"img/82.095b1a06.svg"},"667a":function(t,e,i){t.exports=i.p+"img/66.54dd3ab6.svg"},"9c4e":function(t,e,i){"use strict";i("c27c")},"9d0e":function(t,e,i){},a9ed:function(t,e,i){t.exports=i.p+"img/114.174de4ee.svg"},b10d:function(t,e,i){t.exports=i.p+"img/80.e38a4f66.svg"},b7d6:function(t,e,i){"use strict";i("9d0e")},c27c:function(t,e,i){},cd49:function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var a=i("7a23"),n={class:"app"};function s(t,e,i,s,c,o){var r=Object(a["z"])("router-view");return Object(a["s"])(),Object(a["f"])("div",n,[Object(a["i"])(r)])}var c=Object(a["j"])({name:"App"}),o=(i("b7d6"),i("6b0d")),r=i.n(o);const h=r()(c,[["render",s]]);var l=h,u=i("6c02"),f=function(t){return Object(a["v"])("data-v-205d7497"),t=t(),Object(a["t"])(),t},g={class:"fullscreen"},d={class:"container position-absolute top-50 start-50 translate-middle"},v=f((function(){return Object(a["g"])("h1",{class:"pb-3 pt-3 text-large"},"Simply Chess",-1)})),p={class:"row"},b={class:"col border border-light rounded-1 ms-3 me-3"},k=f((function(){return Object(a["g"])("h3",{class:"pt-3"},"Start a New Game",-1)})),M=f((function(){return Object(a["g"])("p",{class:"pt-3"},"Start a new game in default starting position.",-1)})),y={class:"col border border-light rounded-1 ms-3 me-3"},O=f((function(){return Object(a["g"])("h3",{class:"pt-3"},"Load a Game",-1)})),j=f((function(){return Object(a["g"])("p",{class:"pt-3"},"Load an existing game using a FEN string.",-1)})),m={class:"input-group mb-3"},C={class:"row"},P={class:"col border border-light rounded-1 ms-3 me-3 mt-3"},w=f((function(){return Object(a["g"])("h3",null,"Additional Settings",-1)})),S=Object(a["h"])("Play as: "),A=f((function(){return Object(a["g"])("option",null,"light",-1)})),L=f((function(){return Object(a["g"])("option",null,"dark",-1)})),x=[A,L],q={style:{"margin-bottom":".1em"}},B=Object(a["h"])(" Use AI?");function N(t,e,i,n,s,c){return Object(a["s"])(),Object(a["f"])("div",g,[Object(a["g"])("div",d,[v,Object(a["g"])("div",p,[Object(a["g"])("div",b,[k,M,Object(a["g"])("button",{class:"btn btn-success mb-3",onClick:e[0]||(e[0]=function(){return t.startGame&&t.startGame.apply(t,arguments)})},"New Game")]),Object(a["g"])("div",y,[O,j,Object(a["g"])("div",m,[Object(a["H"])(Object(a["g"])("input",{class:"form-control",type:"text","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.load=e}),placeholder:"Input FEN string here."},null,512),[[a["F"],t.load]]),Object(a["g"])("button",{class:"btn btn-success",onClick:e[2]||(e[2]=function(){return t.startGame&&t.startGame.apply(t,arguments)})},"Load Game")])])]),Object(a["g"])("div",C,[Object(a["g"])("div",P,[w,Object(a["g"])("div",null,[S,Object(a["H"])(Object(a["g"])("select",{"onUpdate:modelValue":e[3]||(e[3]=function(e){return t.playAs=e})},x,512),[[a["E"],t.playAs]])]),Object(a["g"])("div",q,[Object(a["H"])(Object(a["g"])("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=function(e){return t.useAi=e})},null,512),[[a["D"],t.useAi]]),B]),t.useAi?Object(a["H"])((Object(a["s"])(),Object(a["f"])("select",{key:0,style:{"margin-bottom":".2em"},"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.selectedAi=e})},[(Object(a["s"])(!0),Object(a["f"])(a["a"],null,Object(a["y"])(t.aiList,(function(t){return Object(a["s"])(),Object(a["f"])("option",{key:t},Object(a["B"])(t),1)})),128))],512)),[[a["E"],t.selectedAi]]):Object(a["e"])("",!0)])])])])}i("99af");var T=Object(a["j"])({name:"MainMenu",data:function(){return{load:null,useAi:!1,aiList:["RandomMover","MatrixEvaluator"],selectedAi:"RandomMover",playAs:"light"}},methods:{validateFen:function(){return this.load,!0},startGame:function(){if(this.validateFen()){var t=this.load?this.load:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 0";this.$router.push("/play?fen=".concat(t,"&playAs=").concat(this.playAs,"&ai=").concat(this.useAi,"&aiType=").concat(this.selectedAi))}}}});i("9c4e");const F=r()(T,[["render",N],["__scopeId","data-v-205d7497"]]);var K=F,R={id:"app",class:"d-flex flex-row"},D={class:"side-menu mt-1 align-self-center"},H={class:"w-100"},E=Object(a["g"])("h1",null,"Simply Chess",-1),Q={key:0,class:"w-100"},I={key:1,class:"w-100"},V=Object(a["g"])("h2",null,"Tie game!",-1);function W(t,e,i,n,s,c){var o=Object(a["z"])("canvas-board");return Object(a["s"])(),Object(a["f"])("div",R,[Object(a["g"])("div",D,[Object(a["g"])("div",H,[E,Object(a["g"])("p",null,"Piece Placement: "+Object(a["B"])(t.engine.fen.piecePlacement),1),Object(a["g"])("p",null,"Active Color: "+Object(a["B"])(t.engine.fen.activeColor),1),Object(a["g"])("p",null,"Castling Availability: "+Object(a["B"])(t.engine.fen.castlingAvailability),1),Object(a["g"])("p",null,"En Passant Target Square: "+Object(a["B"])(t.engine.fen.enPassantTargetSquare),1),Object(a["g"])("p",null,"Half Move Clock: "+Object(a["B"])(t.engine.fen.halfMoveClock),1),Object(a["g"])("p",null,"Full Move Number: "+Object(a["B"])(t.engine.fen.fullMoveNumber),1),Object(a["g"])("p",null,"Check Status: "+Object(a["B"])(t.engine.checkStatus),1),Object(a["g"])("p",null,"Check Mate Status: "+Object(a["B"])(t.engine.checkMateStatus),1),Object(a["g"])("p",null,"Tie Status: "+Object(a["B"])(t.engine.tie),1),Object(a["g"])("p",null,"Selected Piece: "+Object(a["B"])(t.selectedPiece),1),Object(a["g"])("p",null,"Legal Moves: "+Object(a["B"])(t.legalMoves),1)]),t.engine.checkMateStatus?(Object(a["s"])(),Object(a["f"])("div",Q,[Object(a["g"])("h2",null,"Winner: "+Object(a["B"])("light"===t.engine.checkStatus?"dark":"light"),1),Object(a["g"])("button",{onClick:e[0]||(e[0]=function(){return t.restart&&t.restart.apply(t,arguments)})},"Restart?")])):Object(a["e"])("",!0),t.engine.tie?(Object(a["s"])(),Object(a["f"])("div",I,[V,Object(a["g"])("button",{onClick:e[1]||(e[1]=function(){return t.restart&&t.restart.apply(t,arguments)})},"Restart?")])):Object(a["e"])("",!0)]),Object(a["g"])("div",{class:"float-end",style:Object(a["o"])("width: ".concat(t.containerWidth,"px; height: ").concat(t.containerHeight,"px"))},[t.isMounted?(Object(a["s"])(),Object(a["d"])(o,{key:0,"container-height":t.containerHeight,"container-width":t.containerWidth,"current-board-representation":t.fenString,"legal-moves-for-selection":t.legalMoves,onSelected:t.calculateLegalMoves,onDeselected:t.clearLegalMoves,onMove:t.makeMove},null,8,["container-height","container-width","current-board-representation","legal-moves-for-selection","onSelected","onDeselected","onMove"])):Object(a["e"])("",!0)],4)])}var G={id:"board",ref:"board"};function $(t,e,i,n,s,c){return Object(a["s"])(),Object(a["f"])("div",G,null,512)}var U=i("b85c"),_=(i("a9e3"),i("b0c0"),i("b64b"),i("18a5"),i("7aaa")),z=i("2909"),J=i("3835");i("ac1f"),i("1276"),i("cb29"),i("a434"),i("4e82"),i("4de4"),i("d3b7"),i("caad"),i("2532");function X(t){var e=t.split(" "),i=Object(J["a"])(e,6),a=i[0],n=i[1],s=i[2],c=i[3],o=i[4],r=i[5];return{piecePlacement:a,activeColor:n,castlingAvailability:s,enPassantTargetSquare:c,halfMoveClock:Number(o),fullMoveNumber:Number(r)}}function Y(t){return"".concat(t.piecePlacement," ").concat(t.activeColor," ").concat(t.castlingAvailability," ").concat(t.enPassantTargetSquare," ").concat(t.halfMoveClock," ").concat(t.fullMoveNumber)}function Z(t){for(var e=t.split(""),i=0;i<e.length;i++){var a=e[i].charCodeAt(0);if(a>48&&a<58){var n=a-48,s=Array(n).fill("x");e.splice.apply(e,[i,1].concat(Object(z["a"])(s)))}}return e}function tt(t){var e,i={},a=t.split("/"),n=8,s=Object(U["a"])(a);try{for(s.s();!(e=s.n()).done;){for(var c=e.value,o=Z(c),r=0;r<o.length;r++){var h=ct[r];i["".concat(h,"-").concat(n)]=o[r]}n-=1}}catch(l){s.e(l)}finally{s.f()}return i}function et(t,e){return t.filter((function(t){return t.includes(e)})).sort((function(t,e){return t[0].charCodeAt(0)-e[0].charCodeAt(0)}))}function it(t){var e=Object.keys(t);return[et(e,"8"),et(e,"7"),et(e,"6"),et(e,"5"),et(e,"4"),et(e,"3"),et(e,"2"),et(e,"1")]}function at(t){for(var e="",i=it(t),a=0;a<i.length;a++){for(var n=i[a],s=0,c=0;c<n.length;c++){var o=t[n[c]];"x"===o?s+=1:s>0?(e="".concat(e).concat(s).concat(o),s=0):e="".concat(e).concat(o)}s>0&&(e="".concat(e).concat(s)),a<i.length-1&&(e="".concat(e,"/"))}return e}function nt(t,e){return String.fromCharCode(t.charCodeAt(0)+e)}var st=[8,7,6,5,4,3,2,1],ct=["a","b","c","d","e","f","g","h"],ot=["a-1","a-2","a-3","a-4","a-5","a-6","a-7","a-8","b-1","b-2","b-3","b-4","b-5","b-6","b-7","b-8","c-1","c-2","c-3","c-4","c-5","c-6","c-7","c-8","d-1","d-2","d-3","d-4","d-5","d-6","d-7","d-8","e-1","e-2","e-3","e-4","e-5","e-6","e-7","e-8","f-1","f-2","f-3","f-4","f-5","f-6","f-7","f-8","g-1","g-2","g-3","g-4","g-5","g-6","g-7","g-8","h-1","h-2","h-3","h-4","h-5","h-6","h-7","h-8"];i("4057");function rt(t,e,i,a){var n=i.x+a.x,s=i.y+a.y,c=n+i.width,o=s+i.height;return t<c&&t>n&&e<o&&e>s}function ht(t,e,i,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(n&&rt(t,e,n.parent,a))return n;var s,c=i.filter((function(e){return Math.abs(e.parent.x+a.x-t)<e.parent.width})),o=Object(U["a"])(c);try{for(o.s();!(s=o.n()).done;){var r=s.value;if(rt(t,e,r.parent,a))return r}}catch(h){o.e(h)}finally{o.f()}return null}var lt=Object(a["j"])({name:"CanvasBoard",emits:["selected","deselected","move"],props:{currentBoardRepresentation:{type:String,default:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"},containerHeight:{type:Number,default:100},containerWidth:{type:Number,default:100},boardConfig:{type:Object},legalMovesForSelection:{type:Array,default:function(){return[]}}},data:function(){return{app:new _["a"],containerLength:0,squareLength:0,boardContainer:new _["b"],pieces:{},textures:{},svgs:{},squareMap:{},boardMap:{},fen:{piecePlacement:"",activeColor:"",castlingAvailability:"",enPassantTargetSquare:"",halfMoveClock:0,fullMoveNumber:0},dark:11896931,light:15784373,drag:{dragData:null,dragNode:null,tempContainer:new _["b"],originalParent:null},highlight:{originalPlace:null,closestTarget:null,legalTargets:[]},placedPieces:[],freeSpaces:[],globalOffset:{x:0,y:0},cachedCollision:null}},watch:{currentBoardRepresentation:function(){this.updateFEN(this.currentBoardRepresentation)},legalMovesForSelection:{deep:!0,handler:function(){this.highlightLegalMoves()}}},mounted:function(){this.applyConfig();var t=this.$refs.board;t.style.width=this.containerWidth+"px",t.style.height=this.containerHeight+"px",this.app=new _["a"]({antialias:!0,resolution:window.devicePixelRatio,backgroundAlpha:0,resizeTo:t}),this.calculateContainerLength(),this.calculateSquareLength(),this.loadSVGs(),this.loadTextures();var e=new _["b"];e.interactive=!0,e.on("pointermove",this.onDragMove),this.app.stage.addChild(e),this.boardContainer=e,t.appendChild(this.app.view),this.drawBoard(),this.updateFEN(this.currentBoardRepresentation),this.app.stage.addChild(this.drag.tempContainer),e.x=this.app.screen.width/2,e.y=this.app.screen.height/2,e.pivot.x=e.width/2.28,e.pivot.y=e.height/2.28,this.calculateGlobalOffset()},beforeUnmount:function(){this.app.destroy()},methods:{calculateGlobalOffset:function(){this.globalOffset.x=this.boardContainer.x-this.boardContainer.width/2,this.globalOffset.y=this.boardContainer.y-this.boardContainer.height/2},applyConfig:function(){this.boardConfig&&(this.boardConfig.light&&(this.light=this.boardConfig.light),this.boardConfig.dark&&(this.dark=this.boardConfig.dark))},drawBoard:function(){for(var t=0;t<st.length;t++)for(var e=0;e<ct.length;e++){var i="".concat(ct[e],"-").concat(st[t]),a=e*this.squareLength,n=t*this.squareLength,s=this.getColorForSquare(ct[e],st[t]);this.squareMap[i]=this.drawSquare(a,n,s),this.squareMap[i].name=i}},getColorForSquare:function(t,e){var i=t.charCodeAt(0);return i%2!==0?e%2===0?this.light:this.dark:e%2===0?this.dark:this.light},loadSVGs:function(){this.svgs.B=new _["d"](i("667a"),{width:this.squareLength,height:this.squareLength}),this.svgs.K=new _["d"](i("2ce2"),{width:this.squareLength,height:this.squareLength}),this.svgs.N=new _["d"](i("30a4"),{width:this.squareLength,height:this.squareLength}),this.svgs.P=new _["d"](i("b10d"),{width:this.squareLength,height:this.squareLength}),this.svgs.Q=new _["d"](i("2a19"),{width:this.squareLength,height:this.squareLength}),this.svgs.R=new _["d"](i("49be"),{width:this.squareLength,height:this.squareLength}),this.svgs.b=new _["d"](i("2c77"),{width:this.squareLength,height:this.squareLength}),this.svgs.k=new _["d"](i("3aae"),{width:this.squareLength,height:this.squareLength}),this.svgs.n=new _["d"](i("eb21"),{width:this.squareLength,height:this.squareLength}),this.svgs.p=new _["d"](i("3036"),{width:this.squareLength,height:this.squareLength}),this.svgs.q=new _["d"](i("e229"),{width:this.squareLength,height:this.squareLength}),this.svgs.r=new _["d"](i("a9ed"),{width:this.squareLength,height:this.squareLength})},loadTextures:function(){this.textures.B=_["f"].from(this.svgs.B),this.textures.K=_["f"].from(this.svgs.K),this.textures.N=_["f"].from(this.svgs.N),this.textures.P=_["f"].from(this.svgs.P),this.textures.Q=_["f"].from(this.svgs.Q),this.textures.R=_["f"].from(this.svgs.R),this.textures.b=_["f"].from(this.svgs.b),this.textures.k=_["f"].from(this.svgs.k),this.textures.n=_["f"].from(this.svgs.n),this.textures.p=_["f"].from(this.svgs.p),this.textures.q=_["f"].from(this.svgs.q),this.textures.r=_["f"].from(this.svgs.r)},updateFEN:function(t){this.fen=X(t),this.boardMap=tt(this.fen.piecePlacement),this.clearPieces(),this.placePieces()},findFreeSpaces:function(){for(var t=Object.keys(this.boardMap),e=[],i=0,a=t;i<a.length;i++){var n=a[i];"x"===this.boardMap[n]&&e.push(this.squareMap[n])}this.freeSpaces=e},isPieceInteractive:function(t){return"w"===this.fen.activeColor&&t.charCodeAt(0)<97||"b"===this.fen.activeColor&&t.charCodeAt(0)>97},clearPieces:function(){for(var t=this.placedPieces.length-1;t>=0;t--){var e=this.placedPieces.pop();e&&e.destroy()}},placePieces:function(){for(var t=0,e=Object.keys(this.boardMap);t<e.length;t++){var i=e[t],a=this.boardMap[i];if("x"!==a){var n=this.textures[a],s=new _["e"](n);this.isPieceInteractive(a)&&(s.interactive=!0,s.buttonMode=!0,s.on("pointerdown",this.onDragStart).on("pointerup",this.onDragEnd).on("pointerupoutside",this.onDragEnd)),s.anchor.set(.5),s.name=a;var c=this.squareMap[i];c.addChild(s),this.placedPieces.push(s)}else{var o=new _["e"];o.interactive=!0,o.anchor.set(.5),o.width=this.squareLength,o.height=this.squareLength,o.alpha=0;var r=this.squareMap[i];r.addChild(o),this.placedPieces.push(o)}}},drawSquare:function(t,e,i){var a=new _["b"];if(a.position.set(t,e),this.app){var n=new _["c"];n.beginFill(i),n.drawRect(0,0,this.squareLength,this.squareLength),n.endFill(),n.pivot.x=n.width/2,n.pivot.y=n.height/2,a.addChild(n),this.boardContainer.addChild(a)}return a},onDragStart:function(t){var e;this.drag.dragData=t.data,this.drag.dragNode=t.currentTarget,this.drag.originalParent=null===(e=this.drag.dragNode)||void 0===e?void 0:e.parent,this.highlight.originalPlace=this.createHighlight(16777215),this.drag.originalParent.addChild(this.highlight.originalPlace);var i=t.currentTarget,a=i.name,n=i.parent.name;this.$emit("selected",{piece:a,place:n}),this.drag.dragNode.alpha=.5,this.drag.dragNode.setParent(this.drag.tempContainer),this.onDragMove()},createHighlight:function(t){var e=new _["c"];return e.beginFill(t),e.drawRect(0,0,this.squareLength,this.squareLength),e.endFill(),e.pivot.x=e.width/2,e.pivot.y=e.height/2,e.beginHole(),e.drawRect(this.squareLength/20,this.squareLength/20,this.squareLength-this.squareLength/10,this.squareLength-this.squareLength/10),e.endHole(),e},onDragEnd:function(){if(this.drag.dragNode){if(this.drag.dragNode.alpha=1,this.highlight.closestTarget){var t,e={to:this.highlight.closestTarget.parent.name,from:null===(t=this.highlight.originalPlace)||void 0===t?void 0:t.parent.name,piece:this.drag.dragNode.name};this.$emit("move",e),console.log(e)}this.drag.dragNode.setParent(this.drag.originalParent),this.drag.dragNode.x=0,this.drag.dragNode.y=0}this.highlight.originalPlace&&this.highlight.originalPlace.destroy(),this.highlight.closestTarget&&this.highlight.closestTarget.destroy(),this.clearDrag(),this.clearHighlight(),this.$emit("deselected",!0)},onDragMove:function(){if(this.drag.dragNode){var t=this.drag.dragData.getLocalPosition(this.drag.dragNode.parent);t.x>this.containerWidth?this.drag.dragNode.x=this.containerWidth:t.x<0?this.drag.dragNode.x=0:this.drag.dragNode.x=t.x,t.y>this.containerHeight?this.drag.dragNode.y=this.containerHeight:t.y<0?this.drag.dragNode.y=0:this.drag.dragNode.y=t.y,this.clearCollision();var e=ht(t.x,t.y,this.highlight.legalTargets,this.globalOffset);if(this.cachedCollision=e,e){var i=this.createHighlight(255);e.parent.addChild(i),this.highlight.closestTarget=i}}},clearDrag:function(){this.drag.dragNode=null,this.drag.dragData=null,this.drag.originalParent=null},clearHighlight:function(){this.highlight.originalPlace=null,this.highlight.closestTarget=null,this.clearLegalMoves(),this.clearCollision()},highlightLegalMoves:function(){var t,e=Object(U["a"])(this.legalMovesForSelection);try{for(e.s();!(t=e.n()).done;){var i=t.value,a=this.squareMap[i],n=this.createHighlight(65280);a.addChild(n),this.highlight.legalTargets.push(n)}}catch(s){e.e(s)}finally{e.f()}},clearLegalMoves:function(){for(var t=this.highlight.legalTargets.length-1;t>=0;t--){var e=this.highlight.legalTargets[t];e.destroy(),this.highlight.legalTargets.pop()}},clearCollision:function(){this.highlight.closestTarget&&(this.highlight.closestTarget.destroy(),this.highlight.closestTarget=null)},calculateContainerLength:function(){this.containerLength=this.parentWidth()>this.parentHeight()?this.parentHeight():this.parentWidth()},parentWidth:function(){return this.app?this.app.view.width:0},parentHeight:function(){return this.app?this.app.view.height:0},calculateSquareLength:function(){this.squareLength=this.containerLength/st.length}}});const ut=r()(lt,[["render",$]]);var ft=ut,gt=i("d4ec"),dt=i("bee2"),vt=i("ade3"),pt=(i("5319"),i("e9c4"),i("257e")),bt=i("262e"),kt=i("2caf"),Mt=function(){function t(e,i,a,n){Object(gt["a"])(this,t),Object(vt["a"])(this,"name",void 0),Object(vt["a"])(this,"code",void 0),Object(vt["a"])(this,"color",void 0),Object(vt["a"])(this,"position",void 0),Object(vt["a"])(this,"lastPosition",void 0),Object(vt["a"])(this,"rank",void 0),Object(vt["a"])(this,"file",void 0),Object(vt["a"])(this,"legalMoves",null),Object(vt["a"])(this,"moveType",void 0),Object(vt["a"])(this,"defending",[]),this.color=e,this.position=i,this.lastPosition=null,this.name=a,this.code=this.parseCode();var s=i.split("-"),c=Object(J["a"])(s,2),o=c[0],r=c[1];this.rank=Number(r),this.file=o,this.moveType=n}return Object(dt["a"])(t,[{key:"move",value:function(t){this.lastPosition=this.position,this.position=t;var e=t.split("-"),i=Object(J["a"])(e,2),a=i[0],n=i[1];this.rank=Number(n),this.file=a}},{key:"getLegalMoves",value:function(t,e){return[]}},{key:"filterValidMoves",value:function(t,e){var i=this;return t.filter((function(t){return i.isValidMovePosition(t,e)}))}},{key:"isValidMovePosition",value:function(t,e){var i="dark"===this.color?65:97,a="dark"===this.color?90:122,n="dark"===this.color?97:65,s="dark"===this.color?122:90;if(e[t]){var c=e[t].charCodeAt(0);return"x"===e[t]||(c>=n&&c<=s&&this.defending.push({code:e[t],position:t}),!!e[t]&&e[t].charCodeAt(0)>=i&&e[t].charCodeAt(0)<=a)}return!1}},{key:"isMoveCapture",value:function(t,e){var i="dark"===this.color?65:97,a="dark"===this.color?90:122;return"x"!==e[t]&&(!!e[t]&&e[t].charCodeAt(0)>=i&&e[t].charCodeAt(0)<=a)}},{key:"isOppositeColor",value:function(t){var e=t.charCodeAt(0);return"dark"===this.color?e<=90:e>=97}},{key:"consecutiveMoveSearch",value:function(t,e,i){var a=[],n=!1,s=!1,c=!1,o=!1,r=!1,h=!1,l=!1,u=!1;e&&(s=!0,r=!0,l=!0,u=!0),i&&(n=!0,c=!0,o=!0,h=!0);for(var f=this.rank+1;f<=8;f++){if(!n&&!c&&!s)break;if(s){var g="".concat(this.file,"-").concat(f);this.isValidMovePosition(g,t)?(a.push(g),this.isMoveCapture(g,t)&&(s=!1)):s=!1}if(c){var d="".concat(nt(this.file,f-this.rank),"-").concat(f);this.isValidMovePosition(d,t)?(a.push(d),this.isMoveCapture(d,t)&&(c=!1)):c=!1}if(n){var v="".concat(nt(this.file,-1*(f-this.rank)),"-").concat(f);this.isValidMovePosition(v,t)?(a.push(v),this.isMoveCapture(v,t)&&(n=!1)):n=!1}}for(var p=this.rank-1;p>=1;p--){if(!h&&!o&&!r)break;if(r){var b="".concat(this.file,"-").concat(p);this.isValidMovePosition(b,t)?(a.push(b),this.isMoveCapture(b,t)&&(r=!1)):r=!1}if(o){var k="".concat(nt(this.file,p-this.rank),"-").concat(p);this.isValidMovePosition(k,t)?(a.push(k),this.isMoveCapture(k,t)&&(o=!1)):o=!1}if(h){var M="".concat(nt(this.file,-1*(p-this.rank)),"-").concat(p);this.isValidMovePosition(M,t)?(a.push(M),this.isMoveCapture(M,t)&&(h=!1)):h=!1}}var y=this.file.charCodeAt(0),O=97,j=104;if(l)for(var m=y-1;m>=O;m--){var C="".concat(String.fromCharCode(m),"-").concat(this.rank);if(!this.isValidMovePosition(C,t))break;if(a.push(C),this.isMoveCapture(C,t))break}if(u)for(var P=y+1;P<=j;P++){var w="".concat(String.fromCharCode(P),"-").concat(this.rank);if(!this.isValidMovePosition(w,t))break;if(a.push(w),this.isMoveCapture(w,t))break}return a}},{key:"resetLegalMoves",value:function(){this.legalMoves=null,this.defending.length=0}},{key:"parseCode",value:function(){return"Knight"===this.name?"dark"===this.color?this.name[1].toLowerCase():this.name[1].toUpperCase():"dark"===this.color?this.name[0].toLowerCase():this.name[0].toUpperCase()}}]),t}(),yt=function(t){Object(bt["a"])(i,t);var e=Object(kt["a"])(i);function i(t,a){var n;return Object(gt["a"])(this,i),n=e.call(this,t,a,"Pawn","consecutive"),Object(vt["a"])(Object(pt["a"])(n),"inStartingPosition",void 0),Object(vt["a"])(Object(pt["a"])(n),"direction",void 0),n.direction="dark"===n.color?-1:1,n.inStartingPosition=7===n.rank&&"dark"===n.color||2===n.rank&&"light"===n.color,n}return Object(dt["a"])(i,[{key:"getLegalMoves",value:function(t,e){if(!this.legalMoves){var i=[],a=this.rank+this.direction,n="".concat(this.file,"-").concat(a);if((a<=8||a>=1)&&"x"===t[n]&&(i.push(n),this.inStartingPosition)){var s="".concat(this.file,"-").concat(this.rank+2*this.direction);"x"===t[s]&&i.push(s)}for(var c=nt(this.file,-1),o=nt(this.file,1),r=["".concat(c,"-").concat(a),"".concat(o,"-").concat(a)],h=0,l=r;h<l.length;h++){var u=l[h],f=u[0]+u[2];(f===e.enPassantTargetSquare||t[u]&&"x"!==t[u]&&this.isOppositeColor(t[u]))&&i.push("".concat(u))}this.legalMoves=i}return this.legalMoves}}]),i}(Mt),Ot=function(t){Object(bt["a"])(i,t);var e=Object(kt["a"])(i);function i(t,a){return Object(gt["a"])(this,i),e.call(this,t,a,"Knight","jump")}return Object(dt["a"])(i,[{key:"getLegalMoves",value:function(t,e){return this.legalMoves||(this.legalMoves=[],this.legalMoves.push("".concat(nt(this.file,1),"-").concat(this.rank+2)),this.legalMoves.push("".concat(nt(this.file,-1),"-").concat(this.rank+2)),this.legalMoves.push("".concat(nt(this.file,2),"-").concat(this.rank+1)),this.legalMoves.push("".concat(nt(this.file,-2),"-").concat(this.rank+1)),this.legalMoves.push("".concat(nt(this.file,2),"-").concat(this.rank-1)),this.legalMoves.push("".concat(nt(this.file,-2),"-").concat(this.rank-1)),this.legalMoves.push("".concat(nt(this.file,1),"-").concat(this.rank-2)),this.legalMoves.push("".concat(nt(this.file,-1),"-").concat(this.rank-2)),this.legalMoves=this.filterValidMoves(this.legalMoves,t)),this.legalMoves}}]),i}(Mt),jt=function(t){Object(bt["a"])(i,t);var e=Object(kt["a"])(i);function i(t,a,n){var s;return Object(gt["a"])(this,i),s=e.call(this,t,a,"King","consecutive"),Object(vt["a"])(Object(pt["a"])(s),"canCastleShort",void 0),Object(vt["a"])(Object(pt["a"])(s),"canCastleLong",void 0),Object(vt["a"])(Object(pt["a"])(s),"isInCheck",!1),Object(vt["a"])(Object(pt["a"])(s),"checkBy",null),s.canCastleShort=n.includes("K")&&"light"===t||n.includes("k")&&"dark"===t,s.canCastleLong=n.includes("Q")&&"light"===t||n.includes("q")&&"dark"===t,s}return Object(dt["a"])(i,[{key:"getLegalMoves",value:function(t,e){if(!this.legalMoves){this.legalMoves=[];var i=[];i.push("".concat(nt(this.file,-1),"-").concat(this.rank+1)),i.push("".concat(this.file,"-").concat(this.rank+1)),i.push("".concat(nt(this.file,1),"-").concat(this.rank+1)),i.push("".concat(nt(this.file,-1),"-").concat(this.rank-1)),i.push("".concat(this.file,"-").concat(this.rank-1)),i.push("".concat(nt(this.file,1),"-").concat(this.rank-1)),i.push("".concat(nt(this.file,-1),"-").concat(this.rank)),i.push("".concat(nt(this.file,1),"-").concat(this.rank)),i=this.filterValidMoves(i,t);var a,n=Object(U["a"])(i);try{for(n.s();!(a=n.n()).done;){var s=a.value;1===this.checkCastlingForAttackers([s],t)&&this.legalMoves.push(s)}}catch(f){n.e(f)}finally{n.f()}if(this.canCastleShort&&this.canPerformCastleShort(t)){var c=["".concat(nt(this.file,1),"-").concat(this.rank),"".concat(nt(this.file,2),"-").concat(this.rank)],o=this.checkCastlingForAttackers(c,t);if(2===o){var r="light"===this.color?"g-1":"g-8";this.legalMoves.push(r)}}if(this.canCastleLong&&this.canPerformCastleLong(t)){var h=["".concat(nt(this.file,-1),"-").concat(this.rank),"".concat(nt(this.file,-2),"-").concat(this.rank)],l=this.checkCastlingForAttackers(h,t);if(2===l){var u="light"===this.color?"c-1":"c-8";this.legalMoves.push(u)}}}return this.legalMoves}},{key:"checkCastlingForAttackers",value:function(t,e){var i,a=this.checkBy,n=this.isInCheck,s=this.position,c=this.rank,o=this.file,r=0,h=Object(U["a"])(t);try{for(h.s();!(i=h.n()).done;){var l=i.value,u=JSON.parse(JSON.stringify(e));u[this.position]="x",u[l]=this.code,this.position=l,this.rank=Number(l[2]),this.file=l[0];var f=this.getCheckStatus(u);f.check||(r+=1),this.checkBy=a,this.isInCheck=n}}catch(g){h.e(g)}finally{h.f()}return this.position=s,this.rank=c,this.file=o,r}},{key:"canPerformCastleShort",value:function(t){return"x"===t["".concat(nt(this.file,1),"-").concat(this.rank)]&&"x"===t["".concat(nt(this.file,2),"-").concat(this.rank)]}},{key:"canPerformCastleLong",value:function(t){return"x"===t["".concat(nt(this.file,-1),"-").concat(this.rank)]&&"x"===t["".concat(nt(this.file,-2),"-").concat(this.rank)]&&"x"===t["".concat(nt(this.file,-3),"-").concat(this.rank)]}},{key:"findAttackersFromPositions",value:function(t,e,i){t=t.filter((function(t){return ot.includes(t)}));var a=t.filter((function(t){return e[t]===i}));return a.length>0&&(this.isInCheck=!0,this.checkBy=a[0],!0)}},{key:"checkDirection",value:function(t,e,i,a){if(ot.includes(e)){if("x"===t[e])return!0;if(t[e]===i||t[e]===a)return this.isInCheck=!0,this.checkBy=e,!1}return!1}},{key:"getCheckStatus",value:function(t){var e,i,a,n,s,c;this.isInCheck=!1,this.checkBy=null,"light"===this.color?(e=1,i="n",a="p",n="q",s="r",c="b"):(e=-1,i="N",a="P",n="Q",s="R",c="B");var o=["".concat(nt(this.file,1),"-").concat(this.rank+2),"".concat(nt(this.file,-1),"-").concat(this.rank+2),"".concat(nt(this.file,2),"-").concat(this.rank+1),"".concat(nt(this.file,-2),"-").concat(this.rank+1),"".concat(nt(this.file,2),"-").concat(this.rank-1),"".concat(nt(this.file,-2),"-").concat(this.rank-1),"".concat(nt(this.file,1),"-").concat(this.rank-2),"".concat(nt(this.file,-1),"-").concat(this.rank-2)];if(!this.findAttackersFromPositions(o,t,i)){var r=["".concat(nt(this.file,1),"-").concat(this.rank+e),"".concat(nt(this.file,-1),"-").concat(this.rank+e)];if(!this.findAttackersFromPositions(r,t,a))for(var h=!0,l=!0,u=!0,f=!0,g=!0,d=!0,v=!0,p=!0,b=1;b<=8;b++){if(h){var k="".concat(this.file,"-").concat(this.rank+b);h=this.checkDirection(t,k,n,s)}if(l){var M="".concat(this.file,"-").concat(this.rank-b);l=this.checkDirection(t,M,n,s)}if(u){var y="".concat(nt(this.file,-b),"-").concat(this.rank);u=this.checkDirection(t,y,n,s)}if(f){var O="".concat(nt(this.file,b),"-").concat(this.rank);f=this.checkDirection(t,O,n,s)}if(g){var j="".concat(nt(this.file,-b),"-").concat(this.rank+b);g=this.checkDirection(t,j,n,c)}if(d){var m="".concat(nt(this.file,b),"-").concat(this.rank+b);d=this.checkDirection(t,m,n,c)}if(v){var C="".concat(nt(this.file,-b),"-").concat(this.rank-b);v=this.checkDirection(t,C,n,c)}if(p){var P="".concat(nt(this.file,b),"-").concat(this.rank-b);p=this.checkDirection(t,P,n,c)}if(!h&&!l&&!u&&!f&&!g&&!d&&!v&&!p||this.isInCheck)break}}return{check:this.isInCheck,piece:this.checkBy}}}]),i}(Mt),mt=function(t){Object(bt["a"])(i,t);var e=Object(kt["a"])(i);function i(t,a){return Object(gt["a"])(this,i),e.call(this,t,a,"Queen","consecutive")}return Object(dt["a"])(i,[{key:"getLegalMoves",value:function(t,e){return this.legalMoves||(this.legalMoves=this.consecutiveMoveSearch(t,!0,!0)),this.legalMoves}}]),i}(Mt),Ct=function(t){Object(bt["a"])(i,t);var e=Object(kt["a"])(i);function i(t,a){return Object(gt["a"])(this,i),e.call(this,t,a,"Bishop","consecutive")}return Object(dt["a"])(i,[{key:"getLegalMoves",value:function(t,e){return this.legalMoves||(this.legalMoves=this.consecutiveMoveSearch(t,!1,!0)),this.legalMoves}}]),i}(Mt),Pt=function(t){Object(bt["a"])(i,t);var e=Object(kt["a"])(i);function i(t,a,n){var s;return Object(gt["a"])(this,i),s=e.call(this,t,a,"Rook","consecutive"),Object(vt["a"])(Object(pt["a"])(s),"canCastle",void 0),Object(vt["a"])(Object(pt["a"])(s),"castleSide",void 0),n.includes("q")&&"a-8"===a&&"dark"===s.color?(s.canCastle=!0,s.castleSide="q"):n.includes("k")&&"h-8"===a&&"dark"===s.color?(s.canCastle=!0,s.castleSide="k"):n.includes("Q")&&"a-1"===a&&"light"===s.color?(s.canCastle=!0,s.castleSide="Q"):n.includes("K")&&"h-1"===a&&"light"===s.color?(s.canCastle=!0,s.castleSide="K"):(s.canCastle=!1,s.castleSide="-"),s}return Object(dt["a"])(i,[{key:"getLegalMoves",value:function(t,e){return this.legalMoves||(this.legalMoves=this.consecutiveMoveSearch(t,!0,!1)),this.legalMoves}}]),i}(Mt),wt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";Object(gt["a"])(this,t),Object(vt["a"])(this,"fen",void 0),Object(vt["a"])(this,"boardMap",void 0),Object(vt["a"])(this,"piecesByLocation",void 0),Object(vt["a"])(this,"kings",void 0),Object(vt["a"])(this,"piecesByColor",{light:[],dark:[]}),Object(vt["a"])(this,"checkStatus","none"),Object(vt["a"])(this,"checkMateStatus",!1),Object(vt["a"])(this,"tie",!1),this.fen=X(e),this.boardMap=tt(this.fen.piecePlacement);var i=this.parsePieces(),a=i.piecesByLocation,n=i.kings;this.piecesByLocation=a,this.kings=n,this.resetLegalMovesAndCheckStatus(),this.updateCheckMate()}return Object(dt["a"])(t,[{key:"parsePieces",value:function(){for(var t={},e=new jt("light","",""),i=new jt("light","",""),a=0,n=Object.keys(this.boardMap);a<n.length;a++){var s=n[a],c=this.boardMap[s];if("x"!==c){var o=void 0,r=c.charCodeAt(0)>96?"dark":"light";"p"===c||"P"===c?o=new yt(r,s):"r"===c||"R"===c?o=new Pt(r,s,this.fen.castlingAvailability):"n"===c||"N"===c?o=new Ot(r,s):"b"===c||"B"===c?o=new Ct(r,s):"q"===c||"Q"===c?o=new mt(r,s):(o=new jt(r,s,this.fen.castlingAvailability),"k"===c?i=o:e=o),t[s]=o,this.piecesByColor[r].push(o)}}return{piecesByLocation:t,kings:{k:i,K:e}}}},{key:"getLegalMoves",value:function(t){var e=this.piecesByLocation[t];return e?Object(z["a"])(e.getLegalMoves(this.boardMap,this.fen)):[]}},{key:"move",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.piecesByLocation[t];if(a){var n=a.getLegalMoves(this.boardMap,this.fen);if(n.includes(e)||i){var s=!1;if(this.piecesByLocation[e]||"".concat(e[0]).concat(e[2])===this.fen.enPassantTargetSquare&&"Pawn"===a.name){var c=e;"".concat(e[0]).concat(e[2])===this.fen.enPassantTargetSquare&&"Pawn"===a.name&&(c="".concat(e[0],"-"),"3"===e[2]?c+="4":c+="5");for(var o=this.piecesByLocation[c].color,r=0;r<this.piecesByColor[o].length;r++)if(this.piecesByColor[o][r]===this.piecesByLocation[c]){this.piecesByColor[o].splice(r,1);break}s=!0,delete this.piecesByLocation[c],this.boardMap[c]="x"}a.move(e),"Pawn"!==a.name||1!==a.rank&&8!==a.rank||(a=new mt(a.color,a.position)),this.piecesByLocation[e]=a,this.boardMap[e]=a.code,delete this.piecesByLocation[t],this.boardMap[t]="x",this.updateFEN(a,s),this.resetLegalMovesAndCheckStatus(),this.updateCheckMate()}}return this.fenString}},{key:"updateFEN",value:function(t,e){this.fen.piecePlacement=at(this.boardMap),"dark"===t.color&&(this.fen.fullMoveNumber+=1),"Pawn"===t.name||e?this.fen.halfMoveClock=0:this.fen.halfMoveClock+=1,this.updateEnPassant(t),this.updateCastling(t),this.fen.activeColor="light"===t.color?"b":"w"}},{key:"updateCastling",value:function(t){if("-"!==this.fen.castlingAvailability&&t instanceof jt){var e=this.fen.halfMoveClock,i=this.fen.fullMoveNumber;"light"===t.color?"g-1"===t.position&&this.fen.castlingAvailability.includes("K")?(this.fen.castlingAvailability=this.fen.castlingAvailability.replace("K",""),this.fen.castlingAvailability=this.fen.castlingAvailability.replace("Q",""),this.move("h-1","f-1",!0)):"c-1"===t.position&&this.fen.castlingAvailability.includes("Q")&&(this.fen.castlingAvailability=this.fen.castlingAvailability.replace("Q",""),this.fen.castlingAvailability=this.fen.castlingAvailability.replace("K",""),this.move("a-1","d-1",!0)):"g-8"===t.position&&this.fen.castlingAvailability.includes("k")?(this.fen.castlingAvailability=this.fen.castlingAvailability.replace("k",""),this.fen.castlingAvailability=this.fen.castlingAvailability.replace("q",""),this.move("h-8","f-8",!0)):"c-8"===t.position&&this.fen.castlingAvailability.includes("q")&&(this.fen.castlingAvailability=this.fen.castlingAvailability.replace("q",""),this.fen.castlingAvailability=this.fen.castlingAvailability.replace("k",""),this.move("a-8","d-8",!0)),this.fen.halfMoveClock=e,this.fen.fullMoveNumber=i,t.canCastleShort=!1,t.canCastleLong=!1}else t instanceof Pt&&"-"!==this.fen.castlingAvailability&&("light"===t.color?this.fen.castlingAvailability.includes("K")&&"h-1"===t.lastPosition?this.fen.castlingAvailability=this.fen.castlingAvailability.replace("K",""):this.fen.castlingAvailability.includes("Q")&&"a-1"===t.lastPosition&&(this.fen.castlingAvailability=this.fen.castlingAvailability.replace("Q","")):this.fen.castlingAvailability.includes("k")&&"h-8"===t.lastPosition?this.fen.castlingAvailability=this.fen.castlingAvailability.replace("k",""):this.fen.castlingAvailability.includes("q")&&"a-8"===t.lastPosition&&(this.fen.castlingAvailability=this.fen.castlingAvailability.replace("q","")),t.canCastle=!1,t.castleSide="-");0===this.fen.castlingAvailability.length&&(this.fen.castlingAvailability="-")}},{key:"updateEnPassant",value:function(t){this.fen.enPassantTargetSquare="-",t instanceof yt&&t.inStartingPosition&&(t.inStartingPosition=!1,t.lastPosition&&2===Math.abs(Number(t.lastPosition[2])-Number(t.position[2]))&&(Number(t.lastPosition[2])>t.rank?this.fen.enPassantTargetSquare="".concat(t.file).concat(t.rank+1):this.fen.enPassantTargetSquare="".concat(t.file).concat(t.rank-1)))}},{key:"filterKingMovesDanger",value:function(t,e){var i,a=t.getLegalMoves(this.boardMap,this.fen),n=[],s=Object(U["a"])(e);try{for(s.s();!(i=s.n()).done;){var c=i.value;if(c.legalMoves){if(c instanceof yt){var o,r=Object(U["a"])(c.legalMoves);try{for(r.s();!(o=r.n()).done;){var h=o.value;h[0]!==c.file&&n.push(h)}}catch(g){r.e(g)}finally{r.f()}}else n.push.apply(n,Object(z["a"])(c.legalMoves));var l,u=Object(U["a"])(c.defending);try{for(u.s();!(l=u.n()).done;){var f=l.value;n.push(f.position)}}catch(g){u.e(g)}finally{u.f()}}}}catch(g){s.e(g)}finally{s.f()}t.legalMoves=a.filter((function(t){return!n.includes(t)}))}},{key:"filterMovesCheck",value:function(t,e,i,a){var n=e.checkBy?this.piecesByLocation[e.checkBy]:null,s=[];if(n&&a.length>0){var c=n.moveType;if("King"===t.name){var o,r=[],h=Object(U["a"])(i);try{for(h.s();!(o=h.n()).done;){var l=o.value;if(l.legalMoves){r.push.apply(r,Object(z["a"])(l.legalMoves));var u,f=Object(U["a"])(l.defending);try{for(f.s();!(u=f.n()).done;){var g=u.value;r.push(g.position)}}catch(T){f.e(T)}finally{f.f()}}}}catch(T){h.e(T)}finally{h.f()}(n instanceof mt||n instanceof Pt)&&(n.rank===e.rank?n.file.charCodeAt(0)<e.file.charCodeAt(0)?r.push("".concat(nt(e.file,1),"-").concat(e.rank)):r.push("".concat(nt(e.file,-1),"-").concat(e.rank)):n.file===e.file&&(n.rank>e.rank?r.push("".concat(e.file,"-").concat(e.rank-1)):r.push("".concat(e.file,"-").concat(e.rank+1)))),(n instanceof mt||n instanceof Ct)&&(e.file.charCodeAt(0)<n.file.charCodeAt(0)&&e.rank>n.rank?r.push("".concat(nt(e.file,-1),"-").concat(e.rank+1)):e.file.charCodeAt(0)>n.file.charCodeAt(0)&&e.rank>n.rank?r.push("".concat(nt(e.file,1),"-").concat(e.rank+1)):e.file.charCodeAt(0)<n.file.charCodeAt(0)&&e.rank<n.rank?r.push("".concat(nt(e.file,-1),"-").concat(e.rank-1)):e.file.charCodeAt(0)>n.file.charCodeAt(0)&&e.rank<n.rank&&r.push("".concat(nt(e.file,1),"-").concat(e.rank-1))),s=a.filter((function(t){return!r.includes(t)}))}else{var d=n.legalMoves,v=n.position;if(d&&v){var p=[v];if("consecutive"===c)if(n.file===e.file)if(e.rank>n.rank)for(var b=e.rank-1;b>n.rank;b--){var k="".concat(e.file,"-").concat(b);p.push(k)}else for(var M=n.rank-1;M>e.rank;M--){var y="".concat(e.file,"-").concat(M);p.push(y)}else if(n.rank===e.rank){var O=e.file.charCodeAt(0),j=n.file.charCodeAt(0);if(O<j)for(var m=O+1;m<j;m++){var C="".concat(String.fromCharCode(m),"-").concat(e.rank);p.push(C)}else for(var P=j+1;P<O;P++){var w="".concat(String.fromCharCode(P),"-").concat(e.rank);p.push(w)}}else{var S,A,L=e.file.charCodeAt(0),x=n.file.charCodeAt(0),q=L<x?L+1:x+1;e.rank>n.rank?(S=n.rank+1,A=e.rank):(S=e.rank+1,A=n.rank);for(var B=S;B<A;B++){var N="".concat(String.fromCharCode(q),"-").concat(B);p.push(N),q+=1}}s=a.filter((function(t){return p.includes(t)}))}}}return t.legalMoves=s,s}},{key:"filterMovesThatExposeKing",value:function(t,e){var i,a=t.getLegalMoves(this.boardMap,this.fen),n=e.isInCheck,s=e.checkBy,c=[],o=Object(U["a"])(a);try{for(o.s();!(i=o.n()).done;){var r=i.value,h=JSON.parse(JSON.stringify(this.boardMap));h[r]=t.code,h[t.position]="x",e.getCheckStatus(h),e.isInCheck||c.push(r)}}catch(l){o.e(l)}finally{o.f()}return e.isInCheck=n,e.checkBy=s,c}},{key:"processMovesForColor",value:function(t,e){var i,a,n;"light"===t?(i=this.piecesByColor.light,a=this.kings.K,n=this.piecesByColor.dark):(i=this.piecesByColor.dark,a=this.kings.k,n=this.piecesByColor.light);var s,c=Object(U["a"])(i);try{for(c.s();!(s=c.n()).done;){var o=s.value,r=o.getLegalMoves(this.boardMap,this.fen);e&&this.filterMovesCheck(o,a,n,r),o instanceof jt?this.filterKingMovesDanger(o,n):o.legalMoves=this.filterMovesThatExposeKing(o,a)}}catch(h){c.e(h)}finally{c.f()}}},{key:"resetLegalMovesAndCheckStatus",value:function(){var t,e;"w"===this.fen.activeColor?(t="dark",e="light"):(t="light",e="dark");for(var i=0,a=Object.keys(this.piecesByLocation);i<a.length;i++){var n=a[i];this.piecesByLocation[n].resetLegalMoves()}this.processMovesForColor(t,!1),this.updateCheckStatus(),this.processMovesForColor(e,"none"!==this.checkStatus),this.checkTieStatus()}},{key:"checkTieStatus",value:function(){if("none"===this.checkStatus){var t,e="w"===this.fen.activeColor?"light":"dark",i=!1,a=Object(U["a"])(this.piecesByColor[e]);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.getLegalMoves(this.boardMap,this.fen).length>0){i=!0;break}}}catch(s){a.e(s)}finally{a.f()}i||(this.tie=!0)}}},{key:"getPiecesForOppositeColor",value:function(t){var e="light"===t?"dark":"light";return this.piecesByColor[e]}},{key:"updateCheckStatus",value:function(){var t="none",e="w"===this.fen.activeColor?"light":"dark",i="light"===e?this.kings.K:this.kings.k,a=i.getCheckStatus(this.boardMap);a.check&&(t=e),this.checkStatus=t}},{key:"updateCheckMate",value:function(){var t=[];if("none"!==this.checkStatus){var e,i=this.piecesByColor[this.checkStatus],a=Object(U["a"])(i);try{for(a.s();!(e=a.n()).done;){var n=e.value,s=n.getLegalMoves(this.boardMap,this.fen);t.push.apply(t,Object(z["a"])(s))}}catch(c){a.e(c)}finally{a.f()}this.checkMateStatus=0===t.length}}},{key:"print",value:function(){console.log("\n8|".concat(this.boardMap["a-8"],"|").concat(this.boardMap["b-8"],"|").concat(this.boardMap["c-8"],"|").concat(this.boardMap["d-8"],"|").concat(this.boardMap["e-8"],"|").concat(this.boardMap["f-8"],"|").concat(this.boardMap["g-8"],"|").concat(this.boardMap["h-8"],"|\n7|").concat(this.boardMap["a-7"],"|").concat(this.boardMap["b-7"],"|").concat(this.boardMap["c-7"],"|").concat(this.boardMap["d-7"],"|").concat(this.boardMap["e-7"],"|").concat(this.boardMap["f-7"],"|").concat(this.boardMap["g-7"],"|").concat(this.boardMap["h-7"],"|\n6|").concat(this.boardMap["a-6"],"|").concat(this.boardMap["b-6"],"|").concat(this.boardMap["c-6"],"|").concat(this.boardMap["d-6"],"|").concat(this.boardMap["e-6"],"|").concat(this.boardMap["f-6"],"|").concat(this.boardMap["g-6"],"|").concat(this.boardMap["h-6"],"|\n5|").concat(this.boardMap["a-5"],"|").concat(this.boardMap["b-5"],"|").concat(this.boardMap["c-5"],"|").concat(this.boardMap["d-5"],"|").concat(this.boardMap["e-5"],"|").concat(this.boardMap["f-5"],"|").concat(this.boardMap["g-5"],"|").concat(this.boardMap["h-5"],"|\n4|").concat(this.boardMap["a-4"],"|").concat(this.boardMap["b-4"],"|").concat(this.boardMap["c-4"],"|").concat(this.boardMap["d-4"],"|").concat(this.boardMap["e-4"],"|").concat(this.boardMap["f-4"],"|").concat(this.boardMap["g-4"],"|").concat(this.boardMap["h-4"],"|\n3|").concat(this.boardMap["a-3"],"|").concat(this.boardMap["b-3"],"|").concat(this.boardMap["c-3"],"|").concat(this.boardMap["d-3"],"|").concat(this.boardMap["e-3"],"|").concat(this.boardMap["f-3"],"|").concat(this.boardMap["g-3"],"|").concat(this.boardMap["h-3"],"|\n2|").concat(this.boardMap["a-2"],"|").concat(this.boardMap["b-2"],"|").concat(this.boardMap["c-2"],"|").concat(this.boardMap["d-2"],"|").concat(this.boardMap["e-2"],"|").concat(this.boardMap["f-2"],"|").concat(this.boardMap["g-2"],"|").concat(this.boardMap["h-2"],"|\n1|").concat(this.boardMap["a-1"],"|").concat(this.boardMap["b-1"],"|").concat(this.boardMap["c-1"],"|").concat(this.boardMap["d-1"],"|").concat(this.boardMap["e-1"],"|").concat(this.boardMap["f-1"],"|").concat(this.boardMap["g-1"],"|").concat(this.boardMap["h-1"],"|\n  a b c d e g h h"))}},{key:"fenString",get:function(){return Y(this.fen)}}]),t}(),St=function(){function t(e){Object(gt["a"])(this,t),Object(vt["a"])(this,"color",void 0),this.color=e}return Object(dt["a"])(t,[{key:"move",value:function(t,e,i){return{from:"",to:""}}}]),t}(),At=St,Lt=function(t){Object(bt["a"])(i,t);var e=Object(kt["a"])(i);function i(t){var a;return Object(gt["a"])(this,i),a=e.call(this,t),Object(vt["a"])(Object(pt["a"])(a),"name",void 0),a.name="Random Mover",a}return Object(dt["a"])(i,[{key:"move",value:function(t,e,i){var a,n=[],s=Object(U["a"])(i);try{for(s.s();!(a=s.n()).done;){var c,o=a.value,r=Object(U["a"])(o.getLegalMoves(t,e));try{for(r.s();!(c=r.n()).done;){var h=c.value;n.push({from:o.position,to:h})}}catch(u){r.e(u)}finally{r.f()}}}catch(u){s.e(u)}finally{s.f()}if(n.length>0){var l=Math.floor(Math.random()*n.length);return n[l]}return{from:"",to:""}}}]),i}(At),xt=(i("7db0"),function(t){Object(bt["a"])(i,t);var e=Object(kt["a"])(i);function i(t){var a;return Object(gt["a"])(this,i),a=e.call(this,t),Object(vt["a"])(Object(pt["a"])(a),"name",void 0),Object(vt["a"])(Object(pt["a"])(a),"scores",{pieces:{Pawn:1,Knight:2,Bishop:3,Rook:3,Queen:4,King:5},capture:{multiplier:2},pressure:{multiplier:1.5},danger:{multiplier:-1},defending:{multiplier:1.5},defended:{multiplier:1.5}}),a.name="Matrix Evaluator",a}return Object(dt["a"])(i,[{key:"move",value:function(t,e,i){var a,n=[],s=Object(U["a"])(i);try{for(s.s();!(a=s.n()).done;){var c=a.value;if(c.color===this.color){var o,r=Object(U["a"])(c.getLegalMoves(t,e));try{for(r.s();!(o=r.n()).done;){var h=o.value,l=this.evaluateMove(c,h,t,e,i);n.push({from:c.position,to:h,score:l})}}catch(d){r.e(d)}finally{r.f()}}}}catch(d){s.e(d)}finally{s.f()}if(n.length>0){n.sort((function(t,e){return t.score-e.score}));var u=n[n.length-1].score,f=n.filter((function(t){return t.score===u})),g=Math.floor(Math.random()*f.length);return{from:f[g].from,to:f[g].to}}return{from:"",to:""}}},{key:"evaluateMove",value:function(t,e,i,a,n){var s=this,c=0,o=i[e];if("x"!==o){var r=this.findPieceAtPosition(e,n);r&&(c+=this.scores.pieces[r.name]*this.scores.capture.multiplier);var h=this.findPiecesWithMovesToPosition(e,n);if(h){var l,u=h.filter((function(t){return t.color===s.color})),f=h.filter((function(t){return t.color!==s.color})),g=Object(U["a"])(f);try{for(g.s();!(l=g.n()).done;){var d=l.value;c+=this.scores.pieces[d.name]*this.scores.danger.multiplier}}catch(k){g.e(k)}finally{g.f()}var v,p=Object(U["a"])(u);try{for(p.s();!(v=p.n()).done;){var b=v.value;c+=this.scores.pieces[b.name]*this.scores.defending.multiplier}}catch(k){p.e(k)}finally{p.f()}}this.moveIsForward(t,e)&&(c+=1)}return c}},{key:"findPieceAtPosition",value:function(t,e){return e.find((function(e){return e.position===t}))}},{key:"findPiecesWithMovesToPosition",value:function(t,e){return e.filter((function(e){var i;return null===(i=e.legalMoves)||void 0===i?void 0:i.includes(t)}))}},{key:"moveIsForward",value:function(t,e){return"light"===this.color?Number(e[2])>t.rank:Number(e[2])<t.rank}}]),i}(At)),qt=Object(a["j"])({name:"Play",components:{CanvasBoard:ft},data:function(){return{containerHeight:300,containerWidth:300,isMounted:!1,legalMoves:[],startingFen:"",fenString:"",fen:{piecePlacement:"",activeColor:"",castlingAvailability:"",enPassantTargetSquare:"",halfMoveClock:0,fullMoveNumber:0},useAi:!1,ai:null,engine:new wt,selectedPiece:""}},mounted:function(){this.fenString=String(this.$route.query.fen),this.startingFen=this.fenString,this.useAi="true"===this.$route.query.ai,this.useAi&&(console.log("Creating AI player"),"RandomMover"===this.$route.query.aiType?this.ai=new Lt("dark"):"MatrixEvaluator"===this.$route.query.aiType&&(this.ai=new xt("dark"))),this.engine=new wt(this.fenString),console.log("created new engine"),this.onResize(),window.addEventListener("resize",this.onResize),this.isMounted=!0},methods:{onResize:function(){this.containerHeight=window.innerHeight,this.containerWidth=.6*window.innerWidth},calculateLegalMoves:function(t){this.selectedPiece="".concat(t.piece,", ").concat(t.place),this.legalMoves=this.engine.getLegalMoves(t.place)},clearLegalMoves:function(){this.selectedPiece="",this.legalMoves.length=0},makeMove:function(t){if(this.fenString=this.engine.move(t.from,t.to),this.ai&&"b"===this.engine.fen.activeColor){var e=this.ai.move(this.engine.boardMap,this.engine.fen,this.engine.piecesByColor.dark);console.log("AI move: from ".concat(e.from," to ").concat(e.to)),this.fenString=this.engine.move(e.from,e.to)}},restart:function(){this.fenString=this.startingFen,this.engine=new wt(this.fenString)}}});i("00f2");const Bt=r()(qt,[["render",W]]);var Nt=Bt,Tt=[{path:"/",component:K},{path:"/play",component:Nt}],Ft=Object(u["a"])({history:Object(u["b"])(),routes:Tt}),Kt=(i("ab8b"),i("0deb"),Object(a["c"])(l));Kt.use(Ft),Kt.mount("#app")},e229:function(t,e,i){t.exports=i.p+"img/113.8e8aadb6.svg"},eb21:function(t,e,i){t.exports=i.p+"img/110.7ff2da55.svg"}});
//# sourceMappingURL=app-legacy.588bf892.js.map